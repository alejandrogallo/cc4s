CoulombVertexReader [
  (file "../../resources/CoulombVertex.bin")
] [
  (CoulombVertex FullCoulombVertex)
  HoleEigenEnergies ParticleEigenEnergies
].

CoulombIntegralsFromVertex [
  (CoulombVertex FullCoulombVertex)
  HoleEigenEnergies ParticleEigenEnergies
] [
  (PPHHCoulombIntegrals FullPPHHCoulombIntegrals)
].

Mp2EnergyFromCoulombIntegrals [
  (PPHHCoulombIntegrals FullPPHHCoulombIntegrals)
  HoleEigenEnergies ParticleEigenEnergies
] [
  (Mp2Energy FullMp2Energy)
].

TensorWriter [(Data FullMp2Energy)] [].

% and now approximated:

CoulombVertexSingularVectors [
  FullCoulombVertex
  (fieldVariables 8)
  (reduction 0.5)
] [
  CoulombVertexSingularVectors
].

ApproximateCoulombVertex [
  FullCoulombVertex
  CoulombVertexSingularVectors
] [
  CoulombVertex
].

CoulombIntegralsFromVertex [
  CoulombVertex HoleEigenEnergies ParticleEigenEnergies
] [
  PPHHCoulombIntegrals
].

Mp2EnergyFromCoulombIntegrals [
  PPHHCoulombIntegrals HoleEigenEnergies ParticleEigenEnergies
] [
  Mp2Energy
].

TensorWriter [(Data Mp2Energy)] [].
