CoulombVertexReader [
  (file "../../resources/CoulombVertex.bin")
] [
  CoulombVertex HoleEigenEnergies ParticleEigenEnergies
].

CoulombIntegralsFromVertex [
  CoulombVertex HoleEigenEnergies ParticleEigenEnergies
] [
  PPPPCoulombIntegrals
  PPPHCoulombIntegrals
  PHPHCoulombIntegrals
  PPHHCoulombIntegrals
  HHHHCoulombIntegrals
  HHHPCoulombIntegrals
].

DcsdEnergyFromCoulombIntegrals [
  CoulombVertex
  PPPPCoulombIntegrals
  PPPHCoulombIntegrals
  PHPHCoulombIntegrals
  PPHHCoulombIntegrals
  HHHHCoulombIntegrals
  HHHPCoulombIntegrals
  ParticleEigenEnergies HoleEigenEnergies
  (maxIterations 16)
%  (mixingRatio 0.5381186091710739)
  (mixingRatio 1.556329220888963)
] [
  (DcsdEnergy DcsdEnergy) 
  (DcsdSinglesAmplitudes DcsdSinglesAmplitudes)
  (DcsdDoublesAmplitudes DcsdDoublesAmplitudes)
].

DoublesAmplitudesCholeskyDecomposition [
  (DoublesAmplitudes DcsdDoublesAmplitudes)
  (reduction 10)
] [
  DoublesAmplitudesVertex
  DoublesAmplitudesEigenValues
].

TensorWriter [(Data DoublesAmplitudesEigenValues)] [].
ComplexTensorWriter [(Data DoublesAmplitudesVertex)] [].

ParticleHoleCoulombIntegrals [
  (ParticleHoleCoulombVertex DoublesAmplitudesVertex)
] [
  (PPHHCoulombIntegrals ComposedDoublesAmplitudes)
].

TensorSum [
  (A ComposedDoublesAmplitudes)
  (AFactor 1.0) (AIndex "abij")
  (B DcsdDoublesAmplitudes)
  (BFactor -1.0) (BIndex "abij")
  (ResultIndex "abij")
] [
  (Result ComposedDoublesAmplitudes)
].

TensorNorm [(A ComposedDoublesAmplitudes)] [Norm].

TensorWriter [(Data Norm)] [].
